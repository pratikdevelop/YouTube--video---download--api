<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram - Social Media Video Downloader</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="bg-gray-100">

    <!-- Navbar -->
    <nav class="bg-blue-600 p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <a href="" class="text-white text-2xl font-bold">Social Media Video Downloader</a>
            <ul class="hidden lg:flex space-x-8 items-center">
                <li><a href="youtube" class="text-white hover:text-yellow-300">YouTube</a></li>
                <li><a href="instagram" class="text-white hover:text-yellow-300">Instagram</a></li>
                <li><a href="facebook" class="text-white hover:text-yellow-300">Facebook</a></li>
                <li><a href="image-to-video" class="text-white hover:text-yellow-300">Image to Video</a></li>
                <li><a href="video-generated" class="text-white hover:text-yellow-300">Video Generated by
                        Script</a></li>
            </ul>
            <div class="hidden lg:flex space-x-4">
                <a href="login" class="text-white bg-green-500 px-4 py-2 rounded-md hover:bg-green-700">Login</a>
                <a href="signup" class="text-white bg-yellow-500 px-4 py-2 rounded-md hover:bg-yellow-700">Sign
                    Up</a>
            </div>
        </div>
    </nav>

    <!-- Content -->
    <div class="container mx-auto p-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Download Instagram Videos/Images</h1>
        <p class="text-lg text-gray-600 mb-4">Enter the Instagram URL to download the video or image</p>
        <!-- Add video/image download form or functionality here -->
        <form action="#" method="POST" class="mb-6">
            <input type="url" placeholder="Enter Instagram URL" class="w-full p-3 border border-gray-300 rounded-md"
                required>
            <button type="submit"
                class="w-full bg-blue-600 text-white py-3 rounded-md hover:bg-blue-700 transition duration-300">Download
                Video/Image</button>
        </form>
    </div>
</body>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        document
            .getElementById("videoForm")
            .addEventListener("submit", async (e) => {
                e.preventDefault();
                const platform = document.getElementById("platform").value;
                const url = document.getElementById("videoUrl").value;
                const segmentLength = document.getElementById("segmentLength").value;

                const responseMessage = document.getElementById("responseMessage");
                responseMessage.textContent = "Processing...";

                try {
                    let endpoint = platform === "youtube" ? "/process-video" : `/download-${platform}`;
                    const response = await fetch(endpoint, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(
                            platform === "youtube" ? { url, segment_length: segmentLength } : { url }
                        ),
                    });

                    if (response.ok) {
                        responseMessage.textContent = "Video processed successfully!";
                        fetchProcessedVideos(); // Refresh the list after processing
                    } else {
                        responseMessage.textContent = `Error processing video.`;
                    }
                } catch (error) {
                    responseMessage.textContent = `Error: ${error}`;
                }
            });
    });

    document.addEventListener("DOMContentLoaded", () => {
        const hamburger = document.getElementById('hamburger');
        const mobileMenu = document.getElementById('mobile-menu');

        hamburger.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
    });

    async function fetchProcessedVideos() {
        try {
            const response = await fetch("/list-videos");
            const data = await response.json();
            const videoList = document.getElementById("videoList");
            videoList.innerHTML = "";

            data.videos.forEach((video) => {
                const videoItem = document.createElement("li");
                videoItem.classList.add("bg-white", "p-6", "rounded-lg", "shadow-lg");

                const videoLink = document.createElement("a");
                videoLink.href = video.url;
                videoLink.textContent = video.name;
                videoItem.appendChild(videoLink);
                videoList.appendChild(videoItem);
            });
        } catch (error) {
            console.error("Error fetching processed videos:", error);
        }
    }

    fetchProcessedVideos();
</script>
</html>